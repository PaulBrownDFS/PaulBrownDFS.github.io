!function(){"use strict";var e=function(){this.retries=0,this.timeout=100};e.prototype={baseAjax:function(e){var t=this,i=new XMLHttpRequest;i.overrideMimeType("application/json"),i.open("GET",e.url,!0),i.onload=function(){if(200===i.status){var n=e.formatData?e.formatData(i.responseText):i.responseText;return n.length>0?e.callback(n):(console.error("Error retrieving data",i.responseText),e.callback(!1))}t.retries<9?setTimeout(function(){e.errorCallback(i.status),t.timeout*=2,t.retries+=1},t.timeout):console.error("Error retrieving data",i.responseText)},i.onerror=function(){console.error("Error xhr request")},i.send(null)},getCaData:function(e){var t=this,i=e.url?e.url:encodeURI(e.auth.baseUrl+"/cms/content/query?fullBodyObject=true&scope=tree&store="+e.auth.store+'&query={"sys.iri":"http://content.cms.amplience.com/'+e.auth.id+'"}&v='+Date.now());return this.baseAjax({url:i,callback:function(t){e.callback(t)},errorCallback:function(){t.getCaData(e)},formatData:function(t){return e.formatData?e.formatData(t):t}})},postProcessing:{exec:function(e,t){var i=this;i.dependencies[e].forEach(function(e){i.handlers[e](t)})},dependencies:{slider:["fixFirefoxWhiteOverlay","fixVideoButton","fixAndroidSwipeOverTheVideo"],video:["fixFirefoxWhiteOverlay","fixVideoButton"],splitBlock:["fixFirefoxWhiteOverlay","fixVideoButton"],blog:["fixFirefoxWhiteOverlay","fixVideoButton"],homepage:["fixFirefoxWhiteOverlay","fixVideoButton","fixAndroidSwipeOverTheVideo"]},handlers:{fixAndroidSwipeOverTheVideo:function(){if(navigator.userAgent.match(/Android/i)){var e=document.querySelectorAll(".amp-ca-slider .amp-ca-video");e=Array.prototype.slice.call(e,0),e.forEach(function(e,t){var i=document.createElement("div");i.style.width=e.clientWidth+"px",i.style.height=e.clientHeight-30+"px",i.style.marginBottom=30-e.clientHeight+"px",i.className="inactive-video",e.parentNode.parentNode.insertBefore(i,e.parentNode),i.addEventListener("click",function(){i.classList.add("no-overlay"),e.play()}),e.addEventListener("pause",function(){i.classList.remove("no-overlay")}),window.addEventListener("resize",function(){i.style.width=e.clientWidth+"px",i.style.height=e.clientHeight-30+"px",i.style.marginBottom=30-e.clientHeight+"px"})})}},fixFirefoxWhiteOverlay:function(){var e=document.getElementsByClassName("amp-ca-video"),t=document.getElementsByClassName("video-settings");e=Array.prototype.slice.call(e,0),e.forEach(function(e,i){var n={};n.isFirefox=t[i].dataset.isFirefox,+n.isFirefox&&(e.currentTime=1e-4)})},fixVideoButton:function(){var e=document.querySelectorAll(".amp-ca-video");e=Array.prototype.slice.call(e,0);var t=document.querySelectorAll(".pause-button");t=Array.prototype.slice.call(t,0);var i="click";if(navigator.userAgent.match(/(iPad)|(iPhone)|(Android)/i)?i="touchstart":t.forEach(function(e){e.classList.remove("inactive")}),navigator.userAgent.match(/Android/i))e.forEach(function(e){e.addEventListener(i,function(){var e=this;e.paused?setTimeout(function(){e.play()},1):setTimeout(function(){e.pause()},1)})});else{var n=[],o=function(e){n[e]=!0,setTimeout(function(){n[e]=!1},200)};e.forEach(function(r,a){n[a]=!1,r.addEventListener(i,function(){return function(){n[a]||(e[a].paused?(o(a),setTimeout(function(){e[a].paused&&e[a].play()},200)):(o(a),setTimeout(function(){e[a].pause()},200)))}}()),r.addEventListener("pause",function(){t[a].classList.remove("inactive")}),r.addEventListener("play",function(){t[a].classList.add("inactive")}),t[a].addEventListener(i,function(){n[a]||(e[a].paused?setTimeout(function(){e[a].play()},1):setTimeout(function(){e[a].pause()},1),o(a))})})}}}},constructor:e},window.AmpCa=window.AmpCa||{},window.AmpCa.Utils=e}(),"undefined"!=typeof module?module.exports=window.AmpCa.Utils:"function"==typeof define&&define.amd&&define([],function(){"use strict";return window.AmpCa.Utils});