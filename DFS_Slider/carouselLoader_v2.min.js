function renderContent(e){var s=amp.inlineContent(e)[0];s.spec={roiPrices:s.roi,testDate:s.testDate},s&&renderCarousel(s)}function renderCarousel(e){var s=Handlebars.template(AmpCa.templates.bannerMulti);document.querySelectorAll(".js_banner_wrap")[0].innerHTML=s(e)}function showErrorMessage(e){console.log("Delivery API Request Failure",e),$(document.body).append('<div class="error">An error occurred retrieving your content.<br/><br/>Please ensure that it is published.<br/><br/>Details of the error have been saved to the browser console.</div>')}var slideData={},visualID=$(".js_banner_wrap").data("visualid"),isROI=$(".js_banner_wrap").data("roi");slideIDs=[];var cacheBuster=Math.random().toString(36).substr(2,12);slideGroupId=visualID?visualID:"6b90388f-554a-4651-ae89-a79576867a3f",console.log("Fetching: contentID:",slideGroupId);var masterDeliveryUrl='//c1.adis.ws/cms/content/query?fullBodyObject=true&query=%7B"sys.iri"%3A"http%3A%2F%2Fcontent.cms.amplience.com%2F'+slideGroupId+'"%7D&scope=tree&store=dfs&cacheBuster='+cacheBuster;if($.ajax({url:masterDeliveryUrl}).done(function(e){console.log("Ajax Data Fetch : Done"),renderContent(e)}).fail(function(){console.log("Failed To Get Master ID Data"),showErrorMessage()}).always(function(){console.log("AJAX Has Completed")}),!dfs)var dfs={};if(dfs.carouselText=function(e,s){var a=$("."+e);return a.html(s),a.length?"."+e+" updated to "+s:"Error Updating Carousel, Element Not Found! :("},!dfs)var dfs={};dfs.carCountdown={init:function(){console.log("Countdown Init!"),$(".bannerTextContainer.carCountdown").length>0&&this.addCountDown()},addCountDown:function(){$(".bannerTextContainer.carCountdown").each(function(){var e=this,s=$(e).data(),a=s.countdown,t=s.testdate,n=s.startdays,r=s.messagec,o=s.messaged,l=s.tv1,d=s.tv2,i=s.tv3,c=s.tv4,u=s.messageid.replace("slide_",""),f=dfs.getTimeRemaining(a,t);if(isROI&&(r=r.replace("£","&euro;"),o=o.replace("£","&euro;")),dfs.checkTextData(l,u,t),dfs.checkTextData(d,u,t),dfs.checkTextData(i,u,t),dfs.checkTextData(c,u,t),f.total>0&&f.days<n){console.log("Show Countdown on Slide: "+u),$("h2.message"+u+"b, h2.message"+u+"a").addClass("cdText"),dayOrDays=f.days>1?"DAYS":"DAY";setInterval(function(){var e=dfs.getTimeRemaining(a,t);if(e.hours<10&&(e.hours="0"+e.hours),e.mins<10&&(e.mins="0"+e.mins),e.seconds<10&&(e.seconds="0"+e.seconds),e.days>0)var s="FINAL "+e.days+" "+dayOrDays,n=!0;else var s="ENDS TODAY",n=!1;if(n)var l="& ";else var l="";l=e.hours+"<span>hrs </span>"+e.minutes+"<span>mins </span>"+e.seconds+"<span>secs </span>",line3=0===e.days?r:"",line4=(e.days,o),dfs.carouselText("message"+u+"a",s),dfs.carouselText("message"+u+"b",l),dfs.carouselText("message"+u+"c",line3),dfs.carouselText("message"+u+"d",line4)},1e3)}else console.log("show Static text for slide "+u)})}},dfs.checkTextData=function(e,s,a){var t=e.replace(/,\s+/g,",").split(",");if(6!==t.length)return console.log("slide: "+s+" Invalid Csv Data length, Skipping This Event! ("+e+")"),!1;if(a)var n=new Date(a);else var n=new Date;var r=t[0].split("/"),o=t[1].split("/"),l=new Date(r[1]+"/"+r[0]+"/"+r[2]+" 23:59:59"),d=new Date(o[1]+"/"+o[0]+"/"+o[2]+" 23:59:59");l<=n&&d>=n&&(dfs.carouselText("message"+s+"a",t[2]),dfs.carouselText("message"+s+"b",t[3]),dfs.carouselText("message"+s+"c",t[4]),dfs.carouselText("message"+s+"d",t[5]))},dfs.getTimeRemaining=function(e,s){var a=Date.parse(e)-Date.parse(new Date),t=Math.floor(a/1e3%60),n=Math.floor(a/1e3/60%60),r=Math.floor(a/36e5%24);return{total:a,days:Math.floor(a/864e5),hours:r,minutes:n,seconds:t}},dfs.updateElement=function(){$("#myCarousel").length&&($("#myCarousel").carousel({interval:6e3}),$("#myCarousel").carousel("pause"),clearInterval(PollElement),console.log("Carousel Ready and Initiated : "+PollElement),dfs.carCountdown.init())};var PollElement=setInterval(dfs.updateElement,500);